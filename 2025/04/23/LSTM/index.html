<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LSTM入门教程 | Whz's Note</title><meta name="author" content="Whz"><meta name="copyright" content="Whz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="4月23日,晴天,是上午10点起床的今天的任务,尝试着美化一下页面 LSTM的深度学习作业今天抽空面向kimi编程写完交一下 &#x2F;&#x2F; FileName: LSTM.py#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:UTF-8 -*-&#x27;&#x27;&#x27;@Project:pythonProject1@File:LSTM3.py@IDE:pythonProject1">
<meta property="og:type" content="article">
<meta property="og:title" content="LSTM入门教程">
<meta property="og:url" content="https://whzree.github.io/2025/04/23/LSTM/index.html">
<meta property="og:site_name" content="Whz&#39;s Note">
<meta property="og:description" content="4月23日,晴天,是上午10点起床的今天的任务,尝试着美化一下页面 LSTM的深度学习作业今天抽空面向kimi编程写完交一下 &#x2F;&#x2F; FileName: LSTM.py#!&#x2F;usr&#x2F;bin&#x2F;env python# -*- coding:UTF-8 -*-&#x27;&#x27;&#x27;@Project:pythonProject1@File:LSTM3.py@IDE:pythonProject1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://truth.bahamut.com.tw/s01/202504/forum/60440/7e58afda18c2f1a518b7282b45456143.JPG">
<meta property="article:published_time" content="2025-04-23T05:07:31.769Z">
<meta property="article:modified_time" content="2025-04-23T09:35:40.460Z">
<meta property="article:author" content="Whz">
<meta property="article:tag" content="Markdown">
<meta property="article:tag" content="教程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://truth.bahamut.com.tw/s01/202504/forum/60440/7e58afda18c2f1a518b7282b45456143.JPG"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LSTM入门教程",
  "url": "https://whzree.github.io/2025/04/23/LSTM/",
  "image": "https://truth.bahamut.com.tw/s01/202504/forum/60440/7e58afda18c2f1a518b7282b45456143.JPG",
  "datePublished": "2025-04-23T05:07:31.769Z",
  "dateModified": "2025-04-23T09:35:40.460Z",
  "author": [
    {
      "@type": "Person",
      "name": "Whz",
      "url": "https://whzree.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://whzree.github.io/2025/04/23/LSTM/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/img/pwa/manifest.json"/><link rel="apple-touch-icon" sizes="180x180" href="/img/pwa/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/pwa/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/pwa/16.png"/><link rel="mask-icon" href="/img/pwa/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LSTM入门教程',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/self.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="/css/runtime.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(images/Mario/img_2.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/Mario/img_1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://truth.bahamut.com.tw/s01/202504/forum/60440/7e58afda18c2f1a518b7282b45456143.JPG);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/images/Mario/img.png" alt="Logo"><span class="site-name">Whz's Note</span></a><a class="nav-page-title" href="/"><span class="site-name">LSTM入门教程</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">LSTM入门教程<a class="post-edit-link" href="null_posts/LSTM.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-23T05:07:31.769Z" title="发表于 2025-04-23 13:07:31">2025-04-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-23T09:35:40.460Z" title="更新于 2025-04-23 17:35:40">2025-04-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/">-教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><em><strong>4月23日,晴天,是上午10点起床的</strong></em><br><em><strong>今天的任务,尝试着美化一下页面</strong></em></p>
<h1 id="LSTM的深度学习作业"><a href="#LSTM的深度学习作业" class="headerlink" title="LSTM的深度学习作业"></a>LSTM的深度学习作业</h1><p>今天抽空面向kimi编程写完交一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">// FileName: LSTM.py</span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:UTF-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@Project:pythonProject1</span></span><br><span class="line"><span class="string">@File:LSTM3.py</span></span><br><span class="line"><span class="string">@IDE:pythonProject1</span></span><br><span class="line"><span class="string">@Author:whz</span></span><br><span class="line"><span class="string">@Date:2025/4/23 10:20</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 设置支持中文的字体</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#预测未来的8个值</span></span><br><span class="line"><span class="comment">#跳步时间窗口</span></span><br><span class="line"><span class="comment">#预测未来多个数值</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">数据集查看以及分析：</span></span><br><span class="line"><span class="string">Server, Value, Timestamp, Questionable, Annotated, Substituted</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">data = pd.read_csv(&#x27;./data/机组指令值.csv&#x27;)</span></span><br><span class="line"><span class="string">print(&quot;行数有：&quot;,data.shape[0])</span></span><br><span class="line"><span class="string">print(&quot;列数有:&quot;,data.shape[1])</span></span><br><span class="line"><span class="string">print(&quot;列名有:&quot;,data.columns.tolist())</span></span><br><span class="line"><span class="string">print(data.dtypes)</span></span><br><span class="line"><span class="string"># 打印每列的最大值、最小值、中位数</span></span><br><span class="line"><span class="string">column = &quot; Value&quot;</span></span><br><span class="line"><span class="string">print(f&quot;列名: &#123;column&#125;&quot;)</span></span><br><span class="line"><span class="string">print(&quot;最大值:&quot;, data[column].max())</span></span><br><span class="line"><span class="string">print(&quot;最小值:&quot;, data[column].min())</span></span><br><span class="line"><span class="string">print(&quot;中位数:&quot;, data[column].median())</span></span><br><span class="line"><span class="string">print(&quot;平均值:&quot;, data[column].mean())</span></span><br><span class="line"><span class="string">print(&quot;标准差:&quot;, data[column].std())</span></span><br><span class="line"><span class="string">print(&quot;-&quot; * 30)</span></span><br><span class="line"><span class="string"># 绘制某一列的值</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">column_to_plot = &#x27; Value&#x27;</span></span><br><span class="line"><span class="string">if column_to_plot in data.columns:</span></span><br><span class="line"><span class="string">    plt.figure(figsize=(10, 6))</span></span><br><span class="line"><span class="string">    plt.plot(data[column_to_plot], marker=&#x27;o&#x27;, linestyle=&#x27;-&#x27;)</span></span><br><span class="line"><span class="string">    plt.title(f&#x27;&#123;column_to_plot&#125; 的值&#x27;)</span></span><br><span class="line"><span class="string">    plt.xlabel(&#x27;索引&#x27;)</span></span><br><span class="line"><span class="string">    plt.ylabel(column_to_plot)</span></span><br><span class="line"><span class="string">    plt.grid(True)</span></span><br><span class="line"><span class="string">    plt.show()</span></span><br><span class="line"><span class="string">else:</span></span><br><span class="line"><span class="string">    print(f&quot;列名 &#x27;&#123;column_to_plot&#125;&#x27; 不存在于数据中。&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">列名:  Value</span></span><br><span class="line"><span class="string">最大值: 329.9479</span></span><br><span class="line"><span class="string">最小值: 149.7035</span></span><br><span class="line"><span class="string">中位数: 223.8567</span></span><br><span class="line"><span class="string">平均值: 222.54732904839352</span></span><br><span class="line"><span class="string">标准差: 47.638236488568445</span></span><br><span class="line"><span class="string">------------------------------</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#Server是一列无关特征</span></span><br><span class="line"><span class="comment">#print(data[&#x27;Server&#x27;])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Value, Timestamp, Questionable, Annotated, Substituted</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">unique_values = data[&#x27; Questionable&#x27;].unique()  # 获取唯一值</span></span><br><span class="line"><span class="string">print(f&quot;列 &#x27;&#123;&#x27; Questionable&#x27;&#125;&#x27; 中的唯一值：&quot;)</span></span><br><span class="line"><span class="string">print(unique_values)</span></span><br><span class="line"><span class="string">print(f&quot;\n唯一值的数量：&#123;len(unique_values)&#125;&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">列 &#x27; Questionable&#x27; 中的唯一值：</span></span><br><span class="line"><span class="string">[&#x27; False&#x27;]</span></span><br><span class="line"><span class="string">唯一值的数量：1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">unique_values = data[&#x27; Annotated&#x27;].unique()  # 获取唯一值</span></span><br><span class="line"><span class="string">print(f&quot;列 &#x27;&#123;&#x27; Annotated&#x27;&#125;&#x27; 中的唯一值：&quot;)</span></span><br><span class="line"><span class="string">print(unique_values)</span></span><br><span class="line"><span class="string">print(f&quot;\n唯一值的数量：&#123;len(unique_values)&#125;&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">列 &#x27; Annotated&#x27; 中的唯一值：</span></span><br><span class="line"><span class="string">[&#x27; Not Annotated&#x27;]</span></span><br><span class="line"><span class="string">唯一值的数量：1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">unique_values = data[&#x27; Substituted&#x27;].unique()  # 获取唯一值</span></span><br><span class="line"><span class="string">print(f&quot;列 &#x27;&#123;&#x27; Substituted&#x27;&#125;&#x27; 中的唯一值：&quot;)</span></span><br><span class="line"><span class="string">print(unique_values)</span></span><br><span class="line"><span class="string">print(f&quot;\n唯一值的数量：&#123;len(unique_values)&#125;&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">列 &#x27; Substituted&#x27; 中的唯一值：</span></span><br><span class="line"><span class="string">[&#x27; False&#x27;]</span></span><br><span class="line"><span class="string">唯一值的数量：1</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#综合分析得所有特征列都只有唯一一个值,均是无关特征。所以我们的网络只要预测Value和Timestamp即可</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset, DataLoader</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意力机制层</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Attention</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, hidden_size</span>):</span><br><span class="line">        <span class="built_in">super</span>(Attention, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.attention_layer = nn.Linear(hidden_size, hidden_size)</span><br><span class="line">        <span class="variable language_">self</span>.softmax = nn.Softmax(dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, lstm_output</span>):</span><br><span class="line">        <span class="comment"># lstm_output shape: (batch_size, seq_len, hidden_size)</span></span><br><span class="line">        attention_scores = <span class="variable language_">self</span>.attention_layer(lstm_output)</span><br><span class="line">        attention_scores = torch.tanh(attention_scores)</span><br><span class="line">        attention_weights = <span class="variable language_">self</span>.softmax(attention_scores)</span><br><span class="line">        context = torch.<span class="built_in">sum</span>(attention_weights * lstm_output, dim=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> context</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取CSV文件</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># 黑体</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>  <span class="comment"># 正确显示负号</span></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;./data/机组指令值.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取时间特征</span></span><br><span class="line">data[<span class="string">&#x27;Time&#x27;</span>] = pd.to_datetime(data[<span class="string">&#x27; Timestamp&#x27;</span>])  <span class="comment"># 假设时间列名为 &#x27;Time&#x27;</span></span><br><span class="line">data[<span class="string">&#x27;Month&#x27;</span>] = data[<span class="string">&#x27;Time&#x27;</span>].dt.month</span><br><span class="line">data[<span class="string">&#x27;Day&#x27;</span>] = data[<span class="string">&#x27;Time&#x27;</span>].dt.day</span><br><span class="line">data[<span class="string">&#x27;Hour&#x27;</span>] = data[<span class="string">&#x27;Time&#x27;</span>].dt.hour</span><br><span class="line">data[<span class="string">&#x27;Minute&#x27;</span>] = data[<span class="string">&#x27;Time&#x27;</span>].dt.minute</span><br><span class="line">data[<span class="string">&#x27;Second&#x27;</span>] = data[<span class="string">&#x27;Time&#x27;</span>].dt.second</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对时间特征进行周期编码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_cyclic_features</span>(<span class="params">df, column, max_value</span>):</span><br><span class="line">    df[<span class="string">f&#x27;<span class="subst">&#123;column&#125;</span>_sin&#x27;</span>] = np.sin(<span class="number">2</span> * np.pi * df[column] / max_value)</span><br><span class="line">    df[<span class="string">f&#x27;<span class="subst">&#123;column&#125;</span>_cos&#x27;</span>] = np.cos(<span class="number">2</span> * np.pi * df[column] / max_value)</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line">data = encode_cyclic_features(data, <span class="string">&#x27;Month&#x27;</span>, <span class="number">12</span>)</span><br><span class="line">data = encode_cyclic_features(data, <span class="string">&#x27;Day&#x27;</span>, <span class="number">31</span>)</span><br><span class="line">data = encode_cyclic_features(data, <span class="string">&#x27;Hour&#x27;</span>, <span class="number">24</span>)</span><br><span class="line">data = encode_cyclic_features(data, <span class="string">&#x27;Minute&#x27;</span>, <span class="number">60</span>)</span><br><span class="line">data = encode_cyclic_features(data, <span class="string">&#x27;Second&#x27;</span>, <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取&#x27;Value&#x27;列作为目标变量</span></span><br><span class="line">values = data[[<span class="string">&#x27; Value&#x27;</span>]].values</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据归一化</span></span><br><span class="line">scaler = MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">scaled_values = scaler.fit_transform(values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建时间步特征和跳跃选取&#x27;Value&#x27;的值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_time_features</span>(<span class="params">data, n_steps_in, n_steps_out, n_jump</span>):</span><br><span class="line">    X, y = [], []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data) - n_steps_in - n_steps_out + <span class="number">1</span>, n_jump):</span><br><span class="line">        end_ix = i + n_steps_in</span><br><span class="line">        out_end_ix = end_ix + n_steps_out</span><br><span class="line">        <span class="keyword">if</span> out_end_ix &gt; <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        seq_x = data[i:end_ix]</span><br><span class="line">        seq_y = data[end_ix:out_end_ix]</span><br><span class="line">        X.append(seq_x)</span><br><span class="line">        y.append(seq_y)</span><br><span class="line">    <span class="keyword">return</span> np.array(X), np.array(y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置时间步</span></span><br><span class="line">n_steps_in = <span class="number">30</span>  <span class="comment"># 输入序列长度</span></span><br><span class="line">n_steps_out = <span class="number">2</span>  <span class="comment"># 输出序列长度</span></span><br><span class="line">n_jump = <span class="number">2</span>  <span class="comment"># 跳跃步长</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建序列数据</span></span><br><span class="line">X, y = create_time_features(scaled_values, n_steps_in, n_steps_out, n_jump)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 划分训练集和测试集</span></span><br><span class="line">train_size = <span class="built_in">int</span>(<span class="number">0.8</span> * <span class="built_in">len</span>(X))</span><br><span class="line">X_train, X_test = X[:train_size], X[train_size:]</span><br><span class="line">y_train, y_test = y[:train_size], y[train_size:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加时间编码特征</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_time_features</span>(<span class="params">X, time_data, n_steps_in</span>):</span><br><span class="line">    time_features = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X)):</span><br><span class="line">        start_idx = i * n_jump</span><br><span class="line">        end_idx = start_idx + n_steps_in</span><br><span class="line">        time_window = time_data[start_idx:end_idx]</span><br><span class="line">        time_features.append(time_window)</span><br><span class="line">    time_features = np.array(time_features)</span><br><span class="line">    <span class="keyword">return</span> np.concatenate((X, time_features), axis=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">time_columns = [<span class="string">&#x27;Month_sin&#x27;</span>, <span class="string">&#x27;Month_cos&#x27;</span>, <span class="string">&#x27;Day_sin&#x27;</span>, <span class="string">&#x27;Day_cos&#x27;</span>, <span class="string">&#x27;Hour_sin&#x27;</span>, <span class="string">&#x27;Hour_cos&#x27;</span>, <span class="string">&#x27;Minute_sin&#x27;</span>, <span class="string">&#x27;Minute_cos&#x27;</span>, <span class="string">&#x27;Second_sin&#x27;</span>, <span class="string">&#x27;Second_cos&#x27;</span>]</span><br><span class="line">time_data = data[time_columns].values</span><br><span class="line"></span><br><span class="line">X_train = add_time_features(X_train, time_data, n_steps_in)</span><br><span class="line">X_test = add_time_features(X_test, time_data, n_steps_in)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义数据集类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimeSeriesDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, X, y</span>):</span><br><span class="line">        <span class="variable language_">self</span>.X = torch.tensor(X, dtype=torch.float32)</span><br><span class="line">        <span class="variable language_">self</span>.y = torch.tensor(y, dtype=torch.float32).squeeze(-<span class="number">1</span>)  <span class="comment"># 确保 y 的形状是 (batch_size, output_size)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.X)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.X[idx], <span class="variable language_">self</span>.y[idx]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据加载器</span></span><br><span class="line">train_dataset = TimeSeriesDataset(X_train, y_train)</span><br><span class="line">test_dataset = TimeSeriesDataset(X_test, y_test)</span><br><span class="line"></span><br><span class="line">train_loader = DataLoader(train_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line">test_loader = DataLoader(test_dataset, batch_size=<span class="number">64</span>, shuffle=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设备配置</span></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义多层LSTM-GRU混合模型</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HybridLSTMGRUModel</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_size, hidden_size, lstm_layers, gru_layers, output_size</span>):</span><br><span class="line">        <span class="built_in">super</span>(HybridLSTMGRUModel, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.hidden_size = hidden_size</span><br><span class="line">        <span class="variable language_">self</span>.lstm_layers = lstm_layers</span><br><span class="line">        <span class="variable language_">self</span>.gru_layers = gru_layers</span><br><span class="line">        <span class="comment"># 堆叠的LSTM层</span></span><br><span class="line">        <span class="variable language_">self</span>.lstm_stack = nn.LSTM(input_size, hidden_size, num_layers=lstm_layers, batch_first=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># GRU层</span></span><br><span class="line">        <span class="variable language_">self</span>.gru_stack = nn.GRU(hidden_size, hidden_size, num_layers=gru_layers, batch_first=<span class="literal">True</span>)</span><br><span class="line">        <span class="variable language_">self</span>.dropout = nn.Dropout(<span class="number">0.2</span>)</span><br><span class="line">        <span class="variable language_">self</span>.attention = Attention(hidden_size)</span><br><span class="line">        <span class="variable language_">self</span>.fc = nn.Linear(hidden_size, output_size)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># 初始化LSTM的隐藏状态和细胞状态</span></span><br><span class="line">        h0_lstm = torch.zeros(<span class="variable language_">self</span>.lstm_layers, x.size(<span class="number">0</span>), <span class="variable language_">self</span>.hidden_size).to(x.device)</span><br><span class="line">        c0_lstm = torch.zeros(<span class="variable language_">self</span>.lstm_layers, x.size(<span class="number">0</span>), <span class="variable language_">self</span>.hidden_size).to(x.device)</span><br><span class="line">        <span class="comment"># LSTM层</span></span><br><span class="line">        lstm_out, _ = <span class="variable language_">self</span>.lstm_stack(x, (h0_lstm, c0_lstm))</span><br><span class="line">        <span class="comment"># 初始化GRU的隐藏状态</span></span><br><span class="line">        h0_gru = torch.zeros(<span class="variable language_">self</span>.gru_layers, x.size(<span class="number">0</span>), <span class="variable language_">self</span>.hidden_size).to(x.device)</span><br><span class="line">        <span class="comment"># GRU层</span></span><br><span class="line">        gru_out, _ = <span class="variable language_">self</span>.gru_stack(lstm_out, h0_gru)</span><br><span class="line">        <span class="comment"># 添加Dropout</span></span><br><span class="line">        gru_out = <span class="variable language_">self</span>.dropout(gru_out)</span><br><span class="line">        <span class="comment"># 注意力层</span></span><br><span class="line">        context = <span class="variable language_">self</span>.attention(gru_out)  <span class="comment"># 输出形状: (batch_size, hidden_size)</span></span><br><span class="line">        <span class="comment"># 全连接层</span></span><br><span class="line">        out = <span class="variable language_">self</span>.fc(context)  <span class="comment"># 输出形状: (batch_size, output_size)</span></span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置超参数</span></span><br><span class="line">input_size = X_train.shape[<span class="number">2</span>]  <span class="comment"># 输入特征数量（包括时间编码和stap变量）</span></span><br><span class="line">hidden_size = <span class="number">128</span>  <span class="comment"># 隐藏层大小</span></span><br><span class="line">lstm_layers = <span class="number">2</span>  <span class="comment"># LSTM层数</span></span><br><span class="line">gru_layers = <span class="number">3</span>  <span class="comment"># GRU层数</span></span><br><span class="line">output_size = n_steps_out  <span class="comment"># 输出序列长度</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化模型</span></span><br><span class="line">model = HybridLSTMGRUModel(input_size, hidden_size, lstm_layers, gru_layers, output_size).to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义损失函数和优化器</span></span><br><span class="line">criterion = nn.MSELoss()</span><br><span class="line">optimizer = optim.Adam(model.parameters(), lr=<span class="number">0.001</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练模型</span></span><br><span class="line">num_epochs = <span class="number">100</span>  <span class="comment"># 训练轮数</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    model.train()</span><br><span class="line">    train_loss = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> X_batch, y_batch <span class="keyword">in</span> train_loader:</span><br><span class="line">        X_batch = X_batch.to(device)</span><br><span class="line">        y_batch = y_batch.to(device)</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        outputs = model(X_batch)</span><br><span class="line">        <span class="comment"># 打印调试信息</span></span><br><span class="line">        <span class="comment">#print(f&quot;Model output shape: &#123;outputs.shape&#125;, Target shape: &#123;y_batch.shape&#125;&quot;)</span></span><br><span class="line">        loss = criterion(outputs, y_batch)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line">        train_loss += loss.item() * X_batch.size(<span class="number">0</span>)</span><br><span class="line">    train_loss = train_loss / <span class="built_in">len</span>(train_loader.dataset)</span><br><span class="line">    <span class="comment"># 测试模型</span></span><br><span class="line">    model.<span class="built_in">eval</span>()</span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        predictions = []</span><br><span class="line">        true_values = []</span><br><span class="line">        <span class="keyword">for</span> X_batch, y_batch <span class="keyword">in</span> test_loader:</span><br><span class="line">            X_batch = X_batch.to(device)</span><br><span class="line">            y_batch = y_batch.to(device)</span><br><span class="line">            outputs = model(X_batch)</span><br><span class="line">            predictions.extend(outputs.cpu().numpy())</span><br><span class="line">            true_values.extend(y_batch.cpu().numpy())</span><br><span class="line">        predictions = np.array(predictions)</span><br><span class="line">        true_values = np.array(true_values)</span><br><span class="line">        <span class="comment"># 反归一化</span></span><br><span class="line">        predictions = predictions.reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        true_values = true_values.reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">        predictions_actual = scaler.inverse_transform(predictions)</span><br><span class="line">        true_values_actual = scaler.inverse_transform(true_values)</span><br><span class="line">        <span class="comment"># 计算误差</span></span><br><span class="line">        mse = np.mean((true_values_actual - predictions_actual) ** <span class="number">2</span>)</span><br><span class="line">        mae = np.mean(np.<span class="built_in">abs</span>(true_values_actual - predictions_actual))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;均方误差 (MSE): <span class="subst">&#123;mse&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;平均绝对误差 (MAE): <span class="subst">&#123;mae&#125;</span>&quot;</span>)</span><br><span class="line">        val_loss = val_loss / <span class="built_in">len</span>(test_loader.dataset)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Epoch <span class="subst">&#123;epoch + <span class="number">1</span>&#125;</span>/<span class="subst">&#123;num_epochs&#125;</span>, Train Loss: <span class="subst">&#123;train_loss:<span class="number">.4</span>f&#125;</span>, Val Loss: <span class="subst">&#123;val_loss:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">代码的实现是基于监督学习的训练过程，其目的是让模型学习如何根据历史数据预测未来的值。</span></span><br><span class="line"><span class="string">在训练过程中，我们并不需要将预测值反馈到输入窗口，因为训练数据已经包含了足够多的历史信息。</span></span><br><span class="line"><span class="string">在实际应用中，可以在测试或部署阶段实现，但这需要额外的逻辑来管理输入窗口的更新。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># 绘制预测结果</span></span><br><span class="line"><span class="string">plt.figure(figsize=(12, 6))</span></span><br><span class="line"><span class="string">plt.plot(true_values_actual[:n_steps_out], label=&#x27;True Values&#x27;, marker=&#x27;o&#x27;)</span></span><br><span class="line"><span class="string">plt.plot(predictions_actual[:n_steps_out], label=&#x27;Predicted Values&#x27;, marker=&#x27;x&#x27;)</span></span><br><span class="line"><span class="string">plt.title(&#x27;LSTM-GRU Prediction&#x27;)</span></span><br><span class="line"><span class="string">plt.xlabel(&#x27;Time Step&#x27;)</span></span><br><span class="line"><span class="string">plt.ylabel(&#x27;Value&#x27;)</span></span><br><span class="line"><span class="string">plt.legend()</span></span><br><span class="line"><span class="string">plt.grid(True)</span></span><br><span class="line"><span class="string">plt.show()</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测未来8个时间点的值</span></span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    <span class="comment"># 初始化预测窗口，使用测试集的第一个窗口作为初始窗口</span></span><br><span class="line">    initial_window = X_test[<span class="number">0</span>].unsqueeze(<span class="number">0</span>).to(device)</span><br><span class="line">    predicted_values = []</span><br><span class="line">    current_window = initial_window</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 预测未来8个时间点的值</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        output = model(current_window)</span><br><span class="line">        predicted_value = output[:, -<span class="number">1</span>].unsqueeze(<span class="number">1</span>).unsqueeze(<span class="number">0</span>)  <span class="comment"># 取最后一个时间步的预测值</span></span><br><span class="line">        predicted_values.append(predicted_value)</span><br><span class="line">        <span class="comment"># 更新窗口：移除最旧的数据，添加最新的预测值</span></span><br><span class="line">        current_window = torch.cat((current_window[:, <span class="number">1</span>:, :], predicted_value), dim=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将所有预测值集合起来</span></span><br><span class="line">    predicted_sequence = torch.cat(predicted_values, dim=<span class="number">1</span>)</span><br><span class="line">    predicted_sequence = predicted_sequence.squeeze(<span class="number">0</span>).cpu().numpy()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 反归一化</span></span><br><span class="line">    predicted_sequence = predicted_sequence.reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    predicted_actual = scaler.inverse_transform(predicted_sequence)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成时间点</span></span><br><span class="line">    time_points = pd.date_range(start=<span class="string">&#x27;2025-08-26 00:00:00&#x27;</span>, periods=<span class="number">8</span>, freq=<span class="string">&#x27;H&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 绘制预测结果</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line">    plt.plot(time_points, predicted_actual, label=<span class="string">&#x27;Predicted Values&#x27;</span>, marker=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">&#x27;Future Prediction for August 26th, 0:00 to 7:00&#x27;</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;Time&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;Value&#x27;</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.grid(<span class="literal">True</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://Whzree.github.io">Whz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://whzree.github.io/2025/04/23/LSTM/">https://whzree.github.io/2025/04/23/LSTM/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://Whzree.github.io" target="_blank">Whz's Note</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Markdown/">Markdown</a><a class="post-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/">教程</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/04/22/Mark-down/" title="Markdown入门基础"><img class="cover" src="https://p2.bahamut.com.tw/B/2KU/30/03892af40087dc2521e010ea321ts8e5.JPG?w=1000" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Markdown入门基础</div></div><div class="info-2"><div class="info-item-1">4月22日,阴天,是上午12点起床的 Markdown是什么 要表示标题,只需要在短语面前添加一个井号即可。或者要加粗一个短语只须在短语前后各加两个星号即可 Markdown是独立于平台的,可以在任何操作系统的任何设备上创建Markdown格式的文本 Markdown文档,速查文档  Markdown语法教程2.1标题不同数量的’#’可以完成不同的标题,如下: 一级标题二级标题三级标题2.2 字体粗体，斜体，粗体和斜体，删除线，需要在文字前后加不同的标记符号。如下：这是粗体这是斜体这是粗体加斜体这里想用删除线注：如果想给字体换颜色,或者字体居中显示,需要使用内嵌HTML来实现。这段文字是红色的！ 这段文字是蓝色的。  2.3 无序列表无序列表的使用,在符号’-‘后加空格使用。如下：  无序列表 1 无序列表 2 无序列表 3如果要控制列表的层级,则需要在符号’-‘前使用空格。如下： 无序列表 1 无序列表 2 无序列表 2.1 无序列表 2.2    2.4 有序列表有序列表的使用,在数字及符号’.’后面加空格后输入内容,如下：  有序列表 1 有序列表 2 有序列表...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/04/22/Mark-down/" title="Markdown入门基础"><img class="cover" src="https://p2.bahamut.com.tw/B/2KU/30/03892af40087dc2521e010ea321ts8e5.JPG?w=1000" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-22</div><div class="info-item-2">Markdown入门基础</div></div><div class="info-2"><div class="info-item-1">4月22日,阴天,是上午12点起床的 Markdown是什么 要表示标题,只需要在短语面前添加一个井号即可。或者要加粗一个短语只须在短语前后各加两个星号即可 Markdown是独立于平台的,可以在任何操作系统的任何设备上创建Markdown格式的文本 Markdown文档,速查文档  Markdown语法教程2.1标题不同数量的’#’可以完成不同的标题,如下: 一级标题二级标题三级标题2.2 字体粗体，斜体，粗体和斜体，删除线，需要在文字前后加不同的标记符号。如下：这是粗体这是斜体这是粗体加斜体这里想用删除线注：如果想给字体换颜色,或者字体居中显示,需要使用内嵌HTML来实现。这段文字是红色的！ 这段文字是蓝色的。  2.3 无序列表无序列表的使用,在符号’-‘后加空格使用。如下：  无序列表 1 无序列表 2 无序列表 3如果要控制列表的层级,则需要在符号’-‘前使用空格。如下： 无序列表 1 无序列表 2 无序列表 2.1 无序列表 2.2    2.4 有序列表有序列表的使用,在数字及符号’.’后面加空格后输入内容,如下：  有序列表 1 有序列表 2 有序列表...</div></div></div></a><a class="pagination-related" href="/2025/04/19/hello-world/" title="Hello World"><img class="cover" src="https://truth.bahamut.com.tw/s01/202204/1a09b146efb15bb2d8c8372f6bf9ade4.JPG" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-19</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Whz’s Note! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new &quot;My New Post&quot;  More info: Writing Run server$ hexo server  More info: Server Generate static files$ hexo generate  More info: Generating Deploy to remote sites$ hexo deploy  More info: Deployment </div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Livere</span><span id="switch-btn"></span><span class="second-comment">Waline</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC82MDYwMS8zNzA3Mg"></div></div><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/Mario/img_1.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Whz</div><div class="author-info-description">Whzree_test</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Whzree"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Whzree" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="/whz1597920@gamil" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a><a class="social-icon" href="/1271596860" target="_blank" title="book"><i class="fas fa-address-book" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">4月23日,晴天,是早上10点起床的</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#LSTM%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BD%9C%E4%B8%9A"><span class="toc-number">1.</span> <span class="toc-text">LSTM的深度学习作业</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/23/LSTM/" title="LSTM入门教程"><img src="https://truth.bahamut.com.tw/s01/202504/forum/60440/7e58afda18c2f1a518b7282b45456143.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LSTM入门教程"/></a><div class="content"><a class="title" href="/2025/04/23/LSTM/" title="LSTM入门教程">LSTM入门教程</a><time datetime="2025-04-23T05:07:31.769Z" title="发表于 2025-04-23 13:07:31">2025-04-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/22/Mark-down/" title="Markdown入门基础"><img src="https://p2.bahamut.com.tw/B/2KU/30/03892af40087dc2521e010ea321ts8e5.JPG?w=1000" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Markdown入门基础"/></a><div class="content"><a class="title" href="/2025/04/22/Mark-down/" title="Markdown入门基础">Markdown入门基础</a><time datetime="2025-04-22T04:00:10.666Z" title="发表于 2025-04-22 12:00:10">2025-04-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/19/hello-world/" title="Hello World"><img src="https://truth.bahamut.com.tw/s01/202204/1a09b146efb15bb2d8c8372f6bf9ade4.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2025/04/19/hello-world/" title="Hello World">Hello World</a><time datetime="2025-04-19T05:20:15.095Z" title="发表于 2025-04-19 13:20:15">2025-04-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By Whz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'

  const loadLivere = (el, path) => {
    window.livereOptions = {
      refer: path || location.pathname
    }

    if (isShuoshuo) {
      window.shuoshuoComment.destroyLivere = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    if (typeof LivereTower === 'object') window.LivereTower.init()
    else {
      (function(d, s) {
          var j, e = d.getElementsByTagName(s)[0];
          if (typeof LivereTower === 'function') { return; }
          j = d.createElement(s);
          j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
          j.async = true;
          e.parentNode.insertBefore(j, e);
      })(document, 'script');
    }
  }

  if (isShuoshuo) {
    'Livere' === 'Livere'
      ? window.shuoshuoComment = { loadComment: loadLivere }
      : window.loadOtherComment = loadLivere
    return
  }

  if ('Livere' === 'Livere' || !false) {
    if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
    else loadLivere()
  } else {
    window.loadOtherComment = loadLivere
  }
})()</script><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: '',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      comment: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Livere' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Livere' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script src="xxxx"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://Whzree.github.io/tags/First/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📚 Hello-World,My Note (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://Whzree.github.io/tags/教程/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🎮 Whzの游戏评测 (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://Whzree.github.io/tags/Markdown/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📒 Whzの读书笔记 (2)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item" style="visibility: hidden"></div><a class="magnet_link_more"  href="https://Whzree.github.io/tags" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: #b30070}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://truth.bahamut.com.tw/s01/202503/forum/74934/8b35ae05dc6a97e2efeeb17c2281ca86.JPG?w=1000);"> <a class="categoryBar-list-link" href="categories/教程/">-教程</a><span class="categoryBar-list-count">3</span><span class="categoryBar-list-descr">教程</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/04/23/LSTM/" alt=""><img width="48" height="48" src="https://truth.bahamut.com.tw/s01/202504/forum/60440/7e58afda18c2f1a518b7282b45456143.JPG" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-23</span><a class="blog-slider__title" href="2025/04/23/LSTM/" alt="">LSTM入门教程</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2025/04/23/LSTM/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>